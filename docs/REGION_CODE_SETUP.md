# ì§€ì—­ì½”ë“œ API ì—°ë™ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

**ëª©ì **: í–‰ì •ì•ˆì „ë¶€ ë²•ì •ë™ì½”ë“œ APIë¥¼ í†µí•´ 17ê°œ ì‹œ/ë„ + ì‹œ/êµ°/êµ¬ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ì—¬ Supabase `regions` í…Œì´ë¸”ì— ì €ì¥

**ì‚¬ìš© API**: í–‰ì •ì•ˆì „ë¶€_í–‰ì •í‘œì¤€ì½”ë“œ_ë²•ì •ë™ì½”ë“œ

---

## 1ï¸âƒ£ API í‚¤ ë°œê¸‰ (ìµœìš°ì„ )

### ë°œê¸‰ ì ˆì°¨

1. **ê³µê³µë°ì´í„°í¬í„¸ ì ‘ì†**
   - URL: https://www.data.go.kr
   - íšŒì›ê°€ì… ë˜ëŠ” ë¡œê·¸ì¸

2. **API ê²€ìƒ‰**
   - ê²€ìƒ‰ì–´: "í–‰ì •ì•ˆì „ë¶€ í–‰ì •í‘œì¤€ì½”ë“œ ë²•ì •ë™ì½”ë“œ"
   - ë˜ëŠ” ì§ì ‘ ë§í¬: https://www.data.go.kr/data/15063424/openapi.do

3. **í™œìš©ì‹ ì²­**
   - "í™œìš©ì‹ ì²­" ë²„íŠ¼ í´ë¦­
   - ì‹ ì²­ ì–‘ì‹ ì‘ì„±
   - ìŠ¹ì¸ ëŒ€ê¸° (ë³´í†µ ì¦‰ì‹œ~ìˆ˜ ì‹œê°„)

4. **ì¸ì¦í‚¤ í™•ì¸**
   - ë§ˆì´í˜ì´ì§€ > ì˜¤í”ˆAPI > ê°œë°œê³„ì • ìƒì„¸
   - ì¼ë°˜ ì¸ì¦í‚¤(Decoding) ë³µì‚¬

### API ì •ë³´

```
ì—”ë“œí¬ì¸íŠ¸: http://apis.data.go.kr/1741000/StanReginCd/getStanReginCdList
ë©”ì†Œë“œ: GET (REST)
ë°ì´í„° í¬ë§·: XML / JSON
íŠ¸ë˜í”½ ì œí•œ: 10,000íšŒ/ì¼ (ê°œë°œ ê³„ì •)
```

### ìš”ì²­ íŒŒë¼ë¯¸í„°

| í•­ëª© | ì˜ë¬¸ëª… | í¬ê¸° | í•„ìˆ˜ | ìƒ˜í”Œ | ì„¤ëª… |
|------|--------|------|------|------|------|
| ì„œë¹„ìŠ¤í‚¤ | ServiceKey | 4 | í•„ìˆ˜ | - | ê³µê³µë°ì´í„°í¬í„¸ì—ì„œ ë°œê¸‰ë°›ì€ ì¸ì¦í‚¤ |
| í˜ì´ì§€ ë²ˆí˜¸ | pageNo | 4 | í•„ìˆ˜ | 1 | í˜ì´ì§€ë²ˆí˜¸ (default: 1) |
| í•œ í˜ì´ì§€ ê²°ê³¼ ìˆ˜ | numOfRows | 4 | í•„ìˆ˜ | 100 | í•œ í˜ì´ì§€ ê²°ê³¼ ìˆ˜ (default: 10, max: 1000) |
| í˜¸ì¶œë¬¸ì„œ | type | 4 | í•„ìˆ˜ | json | í˜¸ì¶œë¬¸ì„œ(xml, json) default: xml |
| ì§€ì—­ì£¼ì†Œëª… | locatadd_nm | 50 | ì˜µì…˜ | ì„œìš¸íŠ¹ë³„ì‹œ | ì§€ì—­ì£¼ì†Œëª… (ê²€ìƒ‰ìš©) |

### ì‘ë‹µ ë°ì´í„° êµ¬ì¡°

```json
{
  "resultCode": "INFO-0",
  "resultMsg": "NOMAL SERVICE",
  "numOfRows": 100,
  "pageNo": 1,
  "totalCount": 123,
  "row": [
    {
      "region_cd": "1100000000",      // 10ìë¦¬ ì§€ì—­ì½”ë“œ (í•„ìˆ˜)
      "sido_cd": "11",                // 2ìë¦¬ ì‹œë„ì½”ë“œ
      "sgg_cd": "000",                // 3ìë¦¬ ì‹œêµ°êµ¬ì½”ë“œ
      "umd_cd": "000",                // 3ìë¦¬ ìë©´ë™ì½”ë“œ
      "ri_cd": "00",                  // 2ìë¦¬ ë¦¬ì½”ë“œ
      "locatadd_nm": "ì„œìš¸íŠ¹ë³„ì‹œ",    // ì§€ì—­ì£¼ì†Œëª… (í•„ìˆ˜)
      "locat_order": "11",            // ì„œì—´
      "locat_rm": "",                 // ë¹„ê³ 
      "locathigh_cd": "0000000000",   // ìƒìœ„ì§€ì—­ì½”ë“œ
      "locallow_nm": "ì„œìš¸íŠ¹ë³„ì‹œ",    // ìµœí•˜ìœ„ì§€ì—­ëª…
      "adpt_de": "20000101"           // ìƒì„±ì¼
    }
  ]
}
```

---

## 2ï¸âƒ£ Supabase í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ

### `regions` í…Œì´ë¸” ì„¤ê³„

```sql
-- ì§€ì—­ì½”ë“œ ë§ˆìŠ¤í„° í…Œì´ë¸”
create table regions (
  id bigint primary key generated always as identity,
  region_code varchar(10) unique not null,  -- 10ìë¦¬ ë²•ì •ë™ì½”ë“œ
  name text not null,                       -- ì§€ì—­ëª… (ì„œìš¸íŠ¹ë³„ì‹œ, ê°•ë‚¨êµ¬ ë“±)
  parent_code varchar(10),                  -- ìƒìœ„ ì§€ì—­ì½”ë“œ
  sido_code varchar(2),                     -- ì‹œë„ì½”ë“œ (11, 26 ë“±)
  sgg_code varchar(3),                      -- ì‹œêµ°êµ¬ì½”ë“œ
  depth int not null,                       -- ê¹Šì´ (1:ì‹œë„, 2:ì‹œêµ°êµ¬, 3:ìë©´ë™, 4:ë¦¬)
  order_num int,                            -- ì •ë ¬ ìˆœì„œ
  created_at timestamp with time zone default now(),
  updated_at timestamp with time zone default now()
);

-- ì¸ë±ìŠ¤ ìƒì„±
create index idx_regions_region_code on regions(region_code);
create index idx_regions_parent_code on regions(parent_code);
create index idx_regions_sido_code on regions(sido_code);
create index idx_regions_depth on regions(depth);

-- ì§€ì—­ëª… ê²€ìƒ‰ìš© ì¸ë±ìŠ¤
create index idx_regions_name on regions using gin(to_tsvector('simple', name));
```

### ë°ì´í„° ì˜ˆì‹œ

| region_code | name | parent_code | sido_code | sgg_code | depth |
|-------------|------|-------------|-----------|----------|-------|
| 1100000000 | ì„œìš¸íŠ¹ë³„ì‹œ | NULL | 11 | 000 | 1 |
| 1111000000 | ì¢…ë¡œêµ¬ | 1100000000 | 11 | 110 | 2 |
| 1111010100 | ì²­ìš´ë™ | 1111000000 | 11 | 110 | 3 |

---

## 3ï¸âƒ£ ë¡œì»¬ í™˜ê²½ ì„¤ì •

### `.env` íŒŒì¼ êµ¬ì„±

í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— `.env` íŒŒì¼ ìƒì„±:

```bash
# Supabase
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_KEY=your-service-key-here

# í–‰ì •ì•ˆì „ë¶€ ë²•ì •ë™ì½”ë“œ API
REGION_API_KEY=your-api-key-here
REGION_API_URL=http://apis.data.go.kr/1741000/StanReginCd/getStanReginCdList

# Slack Webhook (ì„ íƒ)
SLACK_WEBHOOK_URL=your-slack-webhook-url
```

### `.env.example` í…œí”Œë¦¿ ìƒì„±

```bash
# Supabase
SUPABASE_URL=https://xxxxx.supabase.co
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# í–‰ì •ì•ˆì „ë¶€ ë²•ì •ë™ì½”ë“œ API
REGION_API_KEY=your_api_key_here
REGION_API_URL=http://apis.data.go.kr/1741000/StanReginCd/getStanReginCdList

# Slack Webhook
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/...
```

### `requirements.txt` ì—…ë°ì´íŠ¸

```txt
# ê¸°ì¡´ íŒ¨í‚¤ì§€ë“¤...
python-dotenv==1.0.0
requests==2.31.0
```

---

## 4ï¸âƒ£ ë°ì´í„° ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸ êµ¬ì¡°

### ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
backend/
â”œâ”€â”€ scripts/                    # ìƒˆë¡œ ìƒì„±
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ collect_region_codes.py    # ì§€ì—­ì½”ë“œ ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸
â”‚   â””â”€â”€ test_region_api.py         # API í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ functions/
â”‚   â””â”€â”€ data_collector/
â”‚       â””â”€â”€ app.py              # í–¥í›„ Lambda í•¨ìˆ˜ë¡œ í†µí•©
```

### ìŠ¤í¬ë¦½íŠ¸ ê¸°ëŠ¥ ëª…ì„¸

#### `test_region_api.py` (API í…ŒìŠ¤íŠ¸)
- API í‚¤ ìœ íš¨ì„± ê²€ì¦
- ìƒ˜í”Œ ë°ì´í„° 10ê°œ ì¡°íšŒ
- ì‘ë‹µ êµ¬ì¡° í™•ì¸

#### `collect_region_codes.py` (ë°ì´í„° ìˆ˜ì§‘)
- ì „ì²´ ë²•ì •ë™ì½”ë“œ ì¡°íšŒ (í˜ì´ì§• ì²˜ë¦¬)
- ì‹œë„/ì‹œêµ°êµ¬/ìë©´ë™/ë¦¬ ë¶„ë¥˜
- Supabase `regions` í…Œì´ë¸”ì— bulk insert
- ì¤‘ë³µ ì²´í¬ ë° ì—…ë°ì´íŠ¸
- Slack ì•Œë¦¼ (ìˆ˜ì§‘ ì™„ë£Œ ì‹œ)

---

## 5ï¸âƒ£ êµ¬í˜„ ë‹¨ê³„

### Phase 1: ë¡œì»¬ í…ŒìŠ¤íŠ¸ (ìš°ì„ )
1. âœ… API í‚¤ ë°œê¸‰
2. âœ… `.env` íŒŒì¼ ì„¤ì •
3. âœ… Supabase í…Œì´ë¸” ìƒì„±
4. âœ… `test_region_api.py` ì‹¤í–‰ (API ì—°ê²° í™•ì¸)
5. âœ… `collect_region_codes.py` ì‹¤í–‰ (ë¡œì»¬ì—ì„œ ë°ì´í„° ìˆ˜ì§‘)

### Phase 2: Lambda í†µí•© (ë‚˜ì¤‘)
1. `DataCollectorFunction`ì— ì§€ì—­ì½”ë“œ ìˆ˜ì§‘ ë¡œì§ í†µí•©
2. EventBridge ìŠ¤ì¼€ì¤„ ì„¤ì • (ì›” 1íšŒ ë˜ëŠ” ìˆ˜ë™ íŠ¸ë¦¬ê±°)
3. CloudWatch ë¡œê·¸ í™•ì¸

---

## 6ï¸âƒ£ ì˜ˆìƒ ë°ì´í„° ê·œëª¨

- **ì‹œ/ë„**: 17ê°œ (ì„œìš¸, ë¶€ì‚°, ëŒ€êµ¬, ì¸ì²œ, ê´‘ì£¼, ëŒ€ì „, ìš¸ì‚°, ì„¸ì¢…, ê²½ê¸°, ê°•ì›, ì¶©ë¶, ì¶©ë‚¨, ì „ë¶, ì „ë‚¨, ê²½ë¶, ê²½ë‚¨, ì œì£¼)
- **ì‹œ/êµ°/êµ¬**: ì•½ 250ê°œ
- **ì/ë©´/ë™**: ì•½ 3,500ê°œ
- **ë¦¬**: ì•½ 30,000ê°œ

**ì´ ë°ì´í„°**: ì•½ **35,000ê°œ** ì˜ˆìƒ

**API í˜¸ì¶œ íšŸìˆ˜**:
- 1íšŒ í˜¸ì¶œë‹¹ ìµœëŒ€ 1,000ê°œ ì¡°íšŒ ê°€ëŠ¥
- ì „ì²´ ë°ì´í„° ìˆ˜ì§‘: ì•½ **35~40íšŒ** í˜¸ì¶œ í•„ìš”
- íŠ¸ë˜í”½ ì œí•œ(10,000íšŒ/ì¼) ë‚´ì—ì„œ ì¶©ë¶„íˆ ê°€ëŠ¥

---

## 7ï¸âƒ£ ì˜¨ë³´ë”© íŒŒì‹± ë¡œì§ ì„¤ê³„

### ì‚¬ìš©ì ì…ë ¥ â†’ ì§€ì—­ì½”ë“œ ë§¤ì¹­

**ì‚¬ìš©ì ì…ë ¥ ì˜ˆì‹œ:**
- "ì„œìš¸ ê°•ë‚¨êµ¬"
- "ê°•ë‚¨"
- "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬"
- "ê²½ê¸°ë„ ì„±ë‚¨ì‹œ ë¶„ë‹¹êµ¬"

**íŒŒì‹± ì „ëµ:**
1. **ì •ê·œì‹ ê¸°ë°˜ ë§¤ì¹­** (ë¹ ë¦„)
   - ì‹œë„ëª… ì¶”ì¶œ (ì„œìš¸, ê²½ê¸°, ë¶€ì‚° ë“±)
   - ì‹œêµ°êµ¬ëª… ì¶”ì¶œ (ê°•ë‚¨êµ¬, ì„±ë‚¨ì‹œ, í•´ìš´ëŒ€êµ¬ ë“±)

2. **DB ê²€ìƒ‰**
   ```sql
   SELECT region_code, name, parent_code, depth
   FROM regions
   WHERE name LIKE '%ê°•ë‚¨%' AND depth <= 2
   ORDER BY depth
   LIMIT 5;
   ```

3. **LLM í´ë°±** (ì• ë§¤í•œ ê²½ìš°)
   - Bedrock Nova Liteì—ê²Œ "ì‚¬ìš©ìê°€ 'ê°•ë‚¨'ì´ë¼ê³  ì…ë ¥í–ˆëŠ”ë°, ì–´ëŠ ì§€ì—­ì¸ê°€ìš”?" ì§ˆë¬¸
   - í›„ë³´ ì§€ì—­ ë¦¬ìŠ¤íŠ¸ ì œê³µ í›„ ì‚¬ìš©ì í™•ì¸

---

## 8ï¸âƒ£ ì°¸ê³  ìë£Œ

### ê³µì‹ ë¬¸ì„œ
- [ê³µê³µë°ì´í„°í¬í„¸ - ë²•ì •ë™ì½”ë“œ API](https://www.data.go.kr/data/15063424/openapi.do)
- [í–‰ì •í‘œì¤€ì½”ë“œê´€ë¦¬ì‹œìŠ¤í…œ](https://www.code.go.kr/)

### ê´€ë ¨ íŒŒì¼
- `docs/TODO.md` - ì „ì²´ ê°œë°œ TODO
- `docs/DATABASE_SCHEMA.md` - DB ìŠ¤í‚¤ë§ˆ ìƒì„¸
- `supabase/schema.sql` - Supabase ìŠ¤í‚¤ë§ˆ íŒŒì¼

---

## 9ï¸âƒ£ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì‹œì‘ ì „
- [ ] ê³µê³µë°ì´í„°í¬í„¸ íšŒì›ê°€ì…
- [ ] ë²•ì •ë™ì½”ë“œ API í™œìš©ì‹ ì²­
- [ ] API í‚¤ ë°œê¸‰ í™•ì¸
- [ ] `.env` íŒŒì¼ ìƒì„± ë° API í‚¤ ì…ë ¥

### ë¡œì»¬ êµ¬í˜„
- [ ] Supabase `regions` í…Œì´ë¸” ìƒì„±
- [ ] `python-dotenv` íŒ¨í‚¤ì§€ ì„¤ì¹˜
- [ ] `test_region_api.py` ì‘ì„± ë° ì‹¤í–‰
- [ ] `collect_region_codes.py` ì‘ì„± ë° ì‹¤í–‰
- [ ] ë°ì´í„° ìˆ˜ì§‘ ì„±ê³µ í™•ì¸ (ìµœì†Œ 17ê°œ ì‹œ/ë„)

### Lambda í†µí•© (í–¥í›„)
- [ ] `DataCollectorFunction`ì— ë¡œì§ í†µí•©
- [ ] ë¡œì»¬ í…ŒìŠ¤íŠ¸ (`sam local invoke`)
- [ ] AWS ë°°í¬ ë° ì‹¤í–‰ í™•ì¸
- [ ] Slack ì•Œë¦¼ í™•ì¸

---

## ğŸš¨ ì£¼ì˜ì‚¬í•­

1. **API í‚¤ ë³´ì•ˆ**
   - `.env` íŒŒì¼ì€ ì ˆëŒ€ Gitì— ì»¤ë°‹í•˜ì§€ ì•ŠìŒ
   - `.gitignore`ì— `.env` ì¶”ê°€ í™•ì¸

2. **íŠ¸ë˜í”½ ì œí•œ**
   - ê°œë°œ ê³„ì •: 10,000íšŒ/ì¼
   - í˜ì´ì§• ìµœëŒ€ê°’: 1,000ê°œ/íšŒ
   - ê³¼ë„í•œ í˜¸ì¶œ ì‹œ ì œí•œë  ìˆ˜ ìˆìŒ

3. **ë°ì´í„° ê°±ì‹  ì£¼ê¸°**
   - ë²•ì •ë™ì½”ë“œëŠ” ìì£¼ ë³€ê²½ë˜ì§€ ì•ŠìŒ
   - **ì›” 1íšŒ** ë˜ëŠ” **ë¶„ê¸° 1íšŒ** ì—…ë°ì´íŠ¸ë¡œ ì¶©ë¶„

4. **ë¡œì»¬ ìš°ì„  ê°œë°œ**
   - AWS Lambda ë°°í¬ëŠ” ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¼
   - ë°˜ë“œì‹œ ë¡œì»¬ì—ì„œ ë¨¼ì € ì™„ë²½íˆ í…ŒìŠ¤íŠ¸ í›„ ë°°í¬

---

**ì‘ì„±ì¼**: 2026-01-20  
**ë‹¤ìŒ ë‹¨ê³„**: API í‚¤ ë°œê¸‰ â†’ ë¡œì»¬ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±

